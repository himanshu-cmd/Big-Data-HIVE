create table loana(id INT,member_id INT,loan_amnt INT,funded_amnt INT,funded_amnt_inv INT,term STRING,int_rate STRING,installment INT,grade STRING,sub_grade STRING,emp_title STRING,emp_length STRING,home_ownership STRING,annual_inc INT,verification_status STRING,issue_d STRING,loan_status STRING,pymnt_plan STRING,url STRING,desc STRING,purpose STRING,title STRING,zip_code STRING,addr_state STRING,dti INT,delinq_2yrs INT,earliest_cr_line STRING,inq_last_6mths INT,mths_since_last_delinq INT,mths_since_last_record INT,open_acc INT,pub_rec INT,revol_bal INT,revol_util INT,total_acc INT,initial_list_status STRING,out_prncp INT,out_prncp_inv INT,total_pymnt INT,total_pymnt_inv INT,total_rec_prncp INT,total_rec_int INT,total_rec_late_fee INT,recoveries INT,collection_recovery_fee INT,last_pymnt_d STRING,last_pymnt_amnt INT,next_pymnt_d STRING,last_credit_pull_d STRING,collections_12_mths_ex_med INT,mths_since_last_major_derog INT,policy_code INT,application_type STRING,annual_inc_joint INT,dti_joint INT,verification_status_joint STRING,acc_now_delinq INT,tot_coll_amt INT,tot_cur_bal INT,open_acc_6m INT,open_il_6m INT,open_il_12m INT,open_il_24m INT,mths_since_rcnt_il INT,total_bal_il INT,il_util INT,open_rv_12m INT,open_rv_24m INT,max_bal_bc INT,all_util INT,total_credit_rv INT,inq_fi INT,total_fi_tl INT,inq_last_12m INT) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");

create table loanb(id INT,member_id INT,loan_amnt INT,funded_amnt INT,funded_amnt_inv INT,term STRING,int_rate STRING,installment INT,grade STRING,sub_grade STRING,emp_title STRING,emp_length STRING,home_ownership STRING,annual_inc INT,verification_status STRING,issue_d STRING,loan_status STRING,pymnt_plan STRING,url STRING,desc STRING,purpose STRING,title STRING,zip_code STRING,addr_state STRING,dti INT,delinq_2yrs INT,earliest_cr_line STRING,inq_last_6mths INT,mths_since_last_delinq INT,mths_since_last_record INT,open_acc INT,pub_rec INT,revol_bal INT,revol_util INT,total_acc INT,initial_list_status STRING,out_prncp INT,out_prncp_inv INT,total_pymnt INT,total_pymnt_inv INT,total_rec_prncp INT,total_rec_int INT,total_rec_late_fee INT,recoveries INT,collection_recovery_fee INT,last_pymnt_d STRING,last_pymnt_amnt INT,next_pymnt_d STRING,last_credit_pull_d STRING,collections_12_mths_ex_med INT,mths_since_last_major_derog INT,policy_code INT,application_type STRING,annual_inc_joint INT,dti_joint INT,verification_status_joint STRING,acc_now_delinq INT,tot_coll_amt INT,tot_cur_bal INT,open_acc_6m INT,open_il_6m INT,open_il_12m INT,open_il_24m INT,mths_since_rcnt_il INT,total_bal_il INT,il_util INT,open_rv_12m INT,open_rv_24m INT,max_bal_bc INT,all_util INT,total_credit_rv INT,inq_fi INT,total_fi_tl INT,inq_last_12m INT) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");

create table loanc(id INT,member_id INT,loan_amnt INT,funded_amnt INT,funded_amnt_inv INT,term STRING,int_rate STRING,installment INT,grade STRING,sub_grade STRING,emp_title STRING,emp_length STRING,home_ownership STRING,annual_inc INT,verification_status STRING,issue_d STRING,loan_status STRING,pymnt_plan STRING,url STRING,desc STRING,purpose STRING,title STRING,zip_code STRING,addr_state STRING,dti INT,delinq_2yrs INT,earliest_cr_line STRING,inq_last_6mths INT,mths_since_last_delinq INT,mths_since_last_record INT,open_acc INT,pub_rec INT,revol_bal INT,revol_util INT,total_acc INT,initial_list_status STRING,out_prncp INT,out_prncp_inv INT,total_pymnt INT,total_pymnt_inv INT,total_rec_prncp INT,total_rec_int INT,total_rec_late_fee INT,recoveries INT,collection_recovery_fee INT,last_pymnt_d STRING,last_pymnt_amnt INT,next_pymnt_d STRING,last_credit_pull_d STRING,collections_12_mths_ex_med INT,mths_since_last_major_derog INT,policy_code INT,application_type STRING,annual_inc_joint INT,dti_joint INT,verification_status_joint STRING,acc_now_delinq INT,tot_coll_amt INT,tot_cur_bal INT,open_acc_6m INT,open_il_6m INT,open_il_12m INT,open_il_24m INT,mths_since_rcnt_il INT,total_bal_il INT,il_util INT,open_rv_12m INT,open_rv_24m INT,max_bal_bc INT,all_util INT,total_credit_rv INT,inq_fi INT,total_fi_tl INT,inq_last_12m INT) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");

create table loand(id INT,member_id INT,loan_amnt INT,funded_amnt INT,funded_amnt_inv INT,term STRING,int_rate STRING,installment INT,grade STRING,sub_grade STRING,emp_title STRING,emp_length STRING,home_ownership STRING,annual_inc INT,verification_status STRING,issue_d STRING,loan_status STRING,pymnt_plan STRING,url STRING,desc STRING,purpose STRING,title STRING,zip_code STRING,addr_state STRING,dti INT,delinq_2yrs INT,earliest_cr_line STRING,inq_last_6mths INT,mths_since_last_delinq INT,mths_since_last_record INT,open_acc INT,pub_rec INT,revol_bal INT,revol_util INT,total_acc INT,initial_list_status STRING,out_prncp INT,out_prncp_inv INT,total_pymnt INT,total_pymnt_inv INT,total_rec_prncp INT,total_rec_int INT,total_rec_late_fee INT,recoveries INT,collection_recovery_fee INT,last_pymnt_d STRING,last_pymnt_amnt INT,next_pymnt_d STRING,last_credit_pull_d STRING,collections_12_mths_ex_med INT,mths_since_last_major_derog INT,policy_code INT,application_type STRING,annual_inc_joint INT,dti_joint INT,verification_status_joint STRING,acc_now_delinq INT,tot_coll_amt INT,tot_cur_bal INT,open_acc_6m INT,open_il_6m INT,open_il_12m INT,open_il_24m INT,mths_since_rcnt_il INT,total_bal_il INT,il_util INT,open_rv_12m INT,open_rv_24m INT,max_bal_bc INT,all_util INT,total_credit_rv INT,inq_fi INT,total_fi_tl INT,inq_last_12m INT) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");

load data local inpath '/home/cloudera/Downloads/Project2/LoanStats3a.csv' overwrite into table loana;
load data local inpath '/home/cloudera/Downloads/Project2/LoanStats3b.csv' overwrite into table loanb;
load data local inpath '/home/cloudera/Downloads/Project2/LoanStats3c.csv' overwrite into table loanc;
load data local inpath '/home/cloudera/Downloads/Project2/LoanStats3d.csv' overwrite into table loand;

select cast(substring(from_unixtime(unix_timestamp(issue_d,'MMM-yy')),1,10) as date) from loanx;


-------------------------------------------------------------------------------------------------------------------------
create table loanx(id INT,member_id INT,loan_amnt INT,funded_amnt INT,funded_amnt_inv INT,term STRING,int_rate STRING,installment INT,grade STRING,sub_grade STRING,emp_title STRING,emp_length STRING,home_ownership STRING,annual_inc INT,verification_status STRING,issue_d STRING,loan_status STRING,pymnt_plan STRING,url STRING,desc STRING,purpose STRING,title STRING,zip_code STRING,addr_state STRING,dti INT,delinq_2yrs INT,earliest_cr_line STRING,inq_last_6mths INT,mths_since_last_delinq INT,mths_since_last_record INT,open_acc INT,pub_rec INT,revol_bal INT,revol_util INT,total_acc INT,initial_list_status STRING,out_prncp INT,out_prncp_inv INT,total_pymnt INT,total_pymnt_inv INT,total_rec_prncp INT,total_rec_int INT,total_rec_late_fee INT,recoveries INT,collection_recovery_fee INT,last_pymnt_d STRING,last_pymnt_amnt INT,next_pymnt_d STRING,last_credit_pull_d STRING,collections_12_mths_ex_med INT,mths_since_last_major_derog INT,policy_code INT,application_type STRING,annual_inc_joint INT,dti_joint INT,verification_status_joint STRING,acc_now_delinq INT,tot_coll_amt INT,tot_cur_bal INT,open_acc_6m INT,open_il_6m INT,open_il_12m INT,open_il_24m INT,mths_since_rcnt_il INT,total_bal_il INT,il_util INT,open_rv_12m INT,open_rv_24m INT,max_bal_bc INT,all_util INT,total_credit_rv INT,inq_fi INT,total_fi_tl INT,inq_last_12m INT) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");
load data local inpath '/home/cloudera/Downloads/Project2/LoanStats3a.csv' overwrite into table loanx;
--------------------------------------------------------------------------------------------------------------------------

create table rejecta(Amount_Requested INT,Application_Date DATE,Loan_Title STRING,Risk_Score INT,Debt_To_Income_Ratio STRING,Zip_Code STRING,State STRING,Employment_Length STRING,Policy_Code INT) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");

create table rejectb(Amount_Requested INT,Application_Date DATE,Loan_Title STRING,Risk_Score INT,Debt_To_Income_Ratio STRING,Zip_Code STRING,State STRING,Employment_Length STRING,Policy_Code INT) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");

create table rejectd(Amount_Requested INT,Application_Date DATE,Loan_Title STRING,Risk_Score INT,Debt_To_Income_Ratio STRING,Zip_Code STRING,State STRING,Employment_Length STRING,Policy_Code INT) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");
---------------------------------------------------------------------------------------------------------------------------
create table building(BuildingID STRING,BuildingMgr STRING,BuildingAge INT,HVACproduct STRING,Country STRING) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");

create table hvac(Date STRING,Time STRING,TargetTemp INT,ActualTemp INT,System INT,SystemAge INT,BuildingID STRING) row format delimited fields terminated by "," stored as textfile tblproperties ("skip.header.line.count"="1");

alter table hvac add columns (temp_diff int);

insert overwrite table hvac2 select Date,Time,TargetTemp,ActualTemp,System,SystemAge,BuildingID,





